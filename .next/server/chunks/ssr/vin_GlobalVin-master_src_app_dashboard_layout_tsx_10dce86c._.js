module.exports=[28941,a=>{"use strict";var b,c,d=a.i(43308),e=a.i(89682);let f=(0,e.default)("bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]]),g=(0,e.default)("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]),h=(0,e.default)("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var i=a.i(29949),j=a.i(86764),k=globalThis?.document?j.useLayoutEffect:()=>{};a.i(70021);var l=a.i(57980),m=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((a,b)=>{let c=(0,l.createSlot)(`Primitive.${b}`),e=j.forwardRef((a,e)=>{let{asChild:f,...g}=a;return(0,d.jsx)(f?c:b,{...g,ref:e})});return e.displayName=`Primitive.${b}`,{...a,[b]:e}},{}),n=a.i(83078);function o(){return()=>{}}var p="Avatar",[q,r]=function(a,b=[]){let c=[],e=()=>{let b=c.map(a=>j.createContext(a));return function(c){let d=c?.[a]||b;return j.useMemo(()=>({[`__scope${a}`]:{...c,[a]:d}}),[c,d])}};return e.scopeName=a,[function(b,e){let f=j.createContext(e);f.displayName=b+"Context";let g=c.length;c=[...c,e];let h=b=>{let{scope:c,children:e,...h}=b,i=c?.[a]?.[g]||f,k=j.useMemo(()=>h,Object.values(h));return(0,d.jsx)(i.Provider,{value:k,children:e})};return h.displayName=b+"Provider",[h,function(c,d){let h=d?.[a]?.[g]||f,i=j.useContext(h);if(i)return i;if(void 0!==e)return e;throw Error(`\`${c}\` must be used within \`${b}\``)}]},function(...a){let b=a[0];if(1===a.length)return b;let c=()=>{let c=a.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(a){let d=c.reduce((b,{useScope:c,scopeName:d})=>{let e=c(a)[`__scope${d}`];return{...b,...e}},{});return j.useMemo(()=>({[`__scope${b.scopeName}`]:d}),[d])}};return c.scopeName=b.scopeName,c}(e,...b)]}(p),[s,t]=q(p),u=j.forwardRef((a,b)=>{let{__scopeAvatar:c,...e}=a,[f,g]=j.useState("idle");return(0,d.jsx)(s,{scope:c,imageLoadingStatus:f,onImageLoadingStatusChange:g,children:(0,d.jsx)(m.span,{...e,ref:b})})});u.displayName=p;var v="AvatarImage",w=j.forwardRef((a,b)=>{var c;let e,{__scopeAvatar:f,src:g,onLoadingStatusChange:h=()=>{},...i}=a,l=t(v,f),p=function(a,{referrerPolicy:b,crossOrigin:c}){let d=(0,n.useSyncExternalStore)(o,()=>!0,()=>!1),e=j.useRef(null),f=d?(e.current||(e.current=new window.Image),e.current):null,[g,h]=j.useState(()=>z(f,a));return k(()=>{h(z(f,a))},[f,a]),k(()=>{let a=a=>()=>{h(a)};if(!f)return;let d=a("loaded"),e=a("error");return f.addEventListener("load",d),f.addEventListener("error",e),b&&(f.referrerPolicy=b),"string"==typeof c&&(f.crossOrigin=c),()=>{f.removeEventListener("load",d),f.removeEventListener("error",e)}},[f,c,b]),g}(g,i),q=(c=a=>{h(a),l.onImageLoadingStatusChange(a)},e=j.useRef(c),j.useEffect(()=>{e.current=c}),j.useMemo(()=>(...a)=>e.current?.(...a),[]));return k(()=>{"idle"!==p&&q(p)},[p,q]),"loaded"===p?(0,d.jsx)(m.img,{...i,ref:b,src:g}):null});w.displayName=v;var x="AvatarFallback",y=j.forwardRef((a,b)=>{let{__scopeAvatar:c,delayMs:e,...f}=a,g=t(x,c),[h,i]=j.useState(void 0===e);return j.useEffect(()=>{if(void 0!==e){let a=window.setTimeout(()=>i(!0),e);return()=>window.clearTimeout(a)}},[e]),h&&"loaded"!==g.imageLoadingStatus?(0,d.jsx)(m.span,{...f,ref:b}):null});function z(a,b){return a?b?(a.src!==b&&(a.src=b),a.complete&&a.naturalWidth>0?"loaded":"loading"):"error":"idle"}y.displayName=x;var A=a.i(81597);function B({className:a,...b}){return(0,d.jsx)(u,{"data-slot":"avatar",className:(0,A.cn)("relative flex size-8 shrink-0 overflow-hidden rounded-full",a),...b})}function C({className:a,...b}){return(0,d.jsx)(w,{"data-slot":"avatar-image",className:(0,A.cn)("aspect-square size-full",a),...b})}function D({className:a,...b}){return(0,d.jsx)(y,{"data-slot":"avatar-fallback",className:(0,A.cn)("bg-muted flex size-full items-center justify-center rounded-full",a),...b})}var E=a.i(39353),F=a.i(11229),G=a.i(183),H=a.i(62452),I=a.i(87257);function J(){let[a,b]=(0,j.useState)(!1),c=(0,E.useRouter)(),e=(0,G.useDispatch)(),{impersonating:k}=(0,G.useSelector)(a=>a.auth),{data:l,isLoading:m,error:n}=(0,F.useProfileQuery)(void 0);console.log(l),console.log(n);let o=l?.data?.user||null;return(0,d.jsxs)("header",{className:"bg-card border-b border-border px-6 py-4 flex items-center justify-between",children:[(0,d.jsxs)("div",{className:"flex items-center gap-3",children:[k&&(0,d.jsxs)("div",{className:"bg-orange-100 border border-orange-300 text-orange-800 px-4 py-2 rounded-lg flex items-center gap-3",children:[(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)("div",{className:"w-2 h-2 bg-orange-500 rounded-full animate-pulse"}),(0,d.jsx)("span",{className:"text-sm font-semibold",children:"Viewing Franchise (View-Only Mode)"})]}),(0,d.jsx)("button",{onClick:()=>{e({type:"auth/stopImpersonation"}),I.toast.success("Stopped impersonation"),c.push("/dashboard/franchises/manage")},className:"text-xs font-medium px-3 py-1 bg-orange-200 hover:bg-orange-300 rounded transition",children:"Exit View Mode"})]}),o?.franchise&&!k&&(0,d.jsxs)("div",{className:"bg-blue-50 border border-blue-200 text-blue-800 px-4 py-2 rounded-lg",children:[(0,d.jsx)("div",{className:"text-xs font-medium",children:"Franchise"}),(0,d.jsx)("div",{className:"text-sm font-semibold",children:o.franchise.name})]})]}),(0,d.jsxs)("div",{className:"flex items-center gap-4",children:[(0,d.jsx)("button",{className:"p-2 hover:bg-muted rounded-lg transition-colors",children:(0,d.jsx)(f,{size:20})}),(0,d.jsxs)("div",{className:"relative pl-4 border-l border-border",children:[(0,d.jsxs)("button",{onClick:()=>b(!a),className:"flex items-center gap-3 hover:opacity-80 transition-opacity",disabled:m,children:[(0,d.jsxs)("div",{className:"text-right",children:[(0,d.jsx)("div",{className:"font-semibold text-sm",children:m?"Loading...":o?.name||"User"}),(0,d.jsx)("div",{className:"text-xs text-muted-foreground",children:o?.role||"Member"})]}),(0,d.jsxs)(B,{className:"w-10 h-10",children:[(0,d.jsx)(C,{src:o?.avatar}),(0,d.jsx)(D,{children:(o?.name||"User").split(" ").map(a=>a[0]).join("").toUpperCase().slice(0,2)})]})]}),a&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>b(!1)}),(0,d.jsxs)("div",{className:"absolute right-0 mt-2 w-64 bg-white rounded-lg shadow-lg border border-gray-200 py-2 z-20",children:[(0,d.jsxs)("div",{className:"px-4 py-3 border-b border-gray-100",children:[(0,d.jsx)("p",{className:"text-sm font-semibold text-gray-900",children:o?.name||"User"}),(0,d.jsx)("p",{className:"text-xs text-gray-500 truncate",children:o?.email||"No email"})]}),(0,d.jsxs)("div",{className:"py-1",children:[(0,d.jsxs)("button",{className:"w-full flex items-center gap-3 px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors",onClick:()=>{b(!1)},children:[(0,d.jsx)(i.User,{size:16}),"Profile"]}),(0,d.jsxs)("button",{className:"w-full flex items-center gap-3 px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors",onClick:()=>{b(!1)},children:[(0,d.jsx)(h,{size:16}),"Settings"]})]}),(0,d.jsx)("div",{className:"border-t border-gray-100 mt-1 pt-1",children:(0,d.jsxs)("button",{onClick:()=>{try{e((0,H.logout)()),I.toast.success("Logged out successfully"),c.push("/auth/login")}catch(a){console.error("Logout failed:",a),I.toast.error("Logout failed. Please try again.")}},className:"w-full flex items-center gap-3 px-4 py-2 text-sm text-red-600 hover:bg-red-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,d.jsx)(g,{size:16}),"Logout"]})})]})]})]})]})]})}var K=a.i(16832),L=((b={}).SUPER_ADMIN="super_admin",b.FRANCHISE_ADMIN="franchise_admin",b.FRANCHISE_USER="franchise_user",b),M=((c={}).VIEW_ALL_FRANCHISES="view_all_franchises",c.MANAGE_FRANCHISES="manage_franchises",c.VIEW_OWN_FRANCHISE="view_own_franchise",c.VIEW_ALL_BILLING="view_all_billing",c.MANAGE_ALL_PRICING="manage_all_pricing",c.VIEW_OWN_BILLING="view_own_billing",c.MANAGE_OWN_BILLING="manage_own_billing",c.TOPUP_CREDITS="topup_credits",c.MANAGE_FRANCHISE_USERS="manage_franchise_users",c.VIEW_ALL_REPORTS="view_all_reports",c.VIEW_FRANCHISE_REPORTS="view_franchise_reports",c.VIEW_OWN_REPORTS="view_own_reports",c.VIEW_ALL_ACTIVITY="view_all_activity",c.VIEW_FRANCHISE_ACTIVITY="view_franchise_activity",c.MANAGE_ALL_API="manage_all_api",c.MANAGE_FRANCHISE_API="manage_franchise_api",c.IMPERSONATE_FRANCHISE="impersonate_franchise",c);L.SUPER_ADMIN,M.VIEW_ALL_FRANCHISES,M.MANAGE_FRANCHISES,M.VIEW_ALL_BILLING,M.MANAGE_ALL_PRICING,M.VIEW_ALL_REPORTS,M.VIEW_ALL_ACTIVITY,M.MANAGE_ALL_API,M.IMPERSONATE_FRANCHISE,M.TOPUP_CREDITS,M.MANAGE_FRANCHISE_USERS,L.FRANCHISE_ADMIN,M.VIEW_OWN_FRANCHISE,M.VIEW_OWN_BILLING,M.MANAGE_OWN_BILLING,M.TOPUP_CREDITS,M.MANAGE_FRANCHISE_USERS,M.VIEW_FRANCHISE_REPORTS,M.VIEW_FRANCHISE_ACTIVITY,M.MANAGE_FRANCHISE_API,L.FRANCHISE_USER,M.VIEW_OWN_REPORTS;let N=a=>a?.role===L.SUPER_ADMIN,O=a=>a?.role===L.FRANCHISE_ADMIN,P=a=>a?.role===L.FRANCHISE_USER,Q=(a,b)=>{let c=a?N(a)?["/dashboard","/dashboard/franchises","/dashboard/franchises/manage","/dashboard/leads","/dashboard/billing","/dashboard/pricing","/dashboard/activity","/dashboard/reports","/dashboard/api","/dashboard/terms"]:O(a)?["/dashboard","/dashboard/billing","/dashboard/activity","/dashboard/reports","/dashboard/api"]:P(a)?["/dashboard","/dashboard/reports"]:["/dashboard"]:[];return!!c.includes(b)||c.some(a=>b.startsWith(a)&&b!==a)},R=(0,e.default)("layout-dashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);var S=a.i(51928),T=a.i(66356),U=a.i(67765),V=a.i(4924);let W=(0,e.default)("file-check",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);var X=a.i(29915),Y=a.i(29309),Z=a.i(4948);let $=(0,e.default)("user-check",[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),_=[{href:"/dashboard",label:"Dashboard",icon:R,roles:["super_admin","franchise_admin","franchise_user"]},{href:"/dashboard/franchises",label:"Franchises",icon:S.Building2,roles:["super_admin"]},{href:"/dashboard/franchises/manage",label:"Manage Franchises",icon:Z.Users,roles:["super_admin"]},{href:"/dashboard/leads",label:"Leads",icon:$,roles:["super_admin"]},{href:"/dashboard/billing",label:"Billing",icon:X.DollarSign,roles:["super_admin","franchise_admin"]},{href:"/dashboard/activity",label:"Activity",icon:Y.Activity,roles:["super_admin","franchise_admin"]},{href:"/dashboard/reports",label:"Reports",icon:T.FileText,roles:["super_admin","franchise_admin","franchise_user"]},{href:"/dashboard/api",label:"API",icon:U.Zap,roles:["super_admin","franchise_admin"]},{href:"/dashboard/pricing",label:"Pricing & Packages",icon:V.Package,roles:["super_admin"]},{href:"/dashboard/terms",label:"Terms & Conditions",icon:W,roles:["super_admin"]}];function aa(){let a=(0,E.usePathname)(),{user:b}=(0,G.useSelector)(a=>a.auth),c=_.filter(a=>!!b&&Q(b,a.href));return(0,d.jsxs)("aside",{className:"w-56 bg-card border-r border-border flex flex-col h-screen",children:[(0,d.jsx)("div",{className:"p-6 border-b border-border",children:(0,d.jsxs)("div",{className:"flex items-center gap-3",children:[(0,d.jsx)("div",{className:"w-8 h-8 bg-primary rounded-md flex items-center justify-center text-primary-foreground font-bold",children:"G"}),(0,d.jsxs)("div",{children:[(0,d.jsx)("h1",{className:"text-lg font-semibold",children:"GlobalVIN"}),b&&(0,d.jsx)("p",{className:"text-xs text-muted-foreground capitalize",children:b.role.replace("_"," ")})]})]})}),(0,d.jsx)("nav",{className:"flex-1 p-4 space-y-2",children:c.map(b=>{let c=b.icon,e="/dashboard"===b.href?"/dashboard"===a:a.startsWith(b.href);return(0,d.jsxs)(K.default,{href:b.href,className:(0,A.cn)("flex items-center gap-3 px-4 py-3 rounded-lg transition-colors",e?"bg-[#764BA2] text-primary-foreground":"text-foreground hover:bg-muted"),children:[(0,d.jsx)(c,{size:20}),(0,d.jsx)("span",{className:"text-sm font-medium",children:b.label})]},b.href)})}),b&&b.franchise&&(0,d.jsxs)("div",{className:"p-4 border-t border-border",children:[(0,d.jsx)("div",{className:"text-xs text-muted-foreground mb-1",children:"Franchise"}),(0,d.jsx)("div",{className:"font-semibold text-sm",children:b.franchise.name}),(0,d.jsx)("div",{className:"text-xs text-muted-foreground mt-1",children:b.franchise.country})]})]})}function ab({children:a,requireRole:b=!1}){let c=(0,E.useRouter)(),e=(0,E.usePathname)(),{token:f,user:g,isAuthenticated:h}=(0,G.useSelector)(a=>a.auth);return((0,j.useEffect)(()=>{if(!f||!h){I.toast.error("Please login to access this page"),c.push(`/auth/login?redirect=${e}`);return}if(b&&g&&!Q(g,e)){let a=g?N(g)?"/dashboard/franchises/manage":O(g)?"/dashboard":P(g)?"/dashboard/reports":"/dashboard":"/auth/login";I.toast.error("You do not have permission to access this page"),c.push(a)}},[f,h,g,e,c,b]),f&&h&&(!b||!g||Q(g,e)))?(0,d.jsx)(d.Fragment,{children:a}):null}function ac({children:a}){return(0,d.jsx)(ab,{requireRole:!0,children:(0,d.jsxs)("div",{className:"flex h-screen",children:[(0,d.jsx)(aa,{}),(0,d.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[(0,d.jsx)(J,{}),(0,d.jsx)("main",{className:"flex-1 overflow-auto bg-background",children:a})]})]})})}a.s(["default",()=>ac],28941)}];

//# sourceMappingURL=vin_GlobalVin-master_src_app_dashboard_layout_tsx_10dce86c._.js.map